/*
 *  Copyright (c) 2011 Daniel Huckaby
 *
 *  Licensed under the Apache License, Version 2.0 (the "License");
 *  you may not use this file except in compliance with the License.
 *  You may obtain a copy of the License at
 *
 *  http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 */
package com.handlerexploit.news.data.models;

import org.json.JSONException;
import org.json.JSONObject;

import android.graphics.drawable.Drawable;
import android.text.Html;
import android.text.Html.ImageGetter;

public class Article {

    private JSONObject jsonObject;

    private String imageThumbnailUrl;

    public Article(JSONObject jsonObject) {
        this.jsonObject = jsonObject;
        Html.fromHtml(getDescription(), new ImageGetter() {
            public Drawable getDrawable(String source) {
                if (imageThumbnailUrl == null) {
                    imageThumbnailUrl = source;
                }
                return null;
            }
        }, null);
    }

    public String getTitle() {
        if (get("title") == null) {
            return null;
        } else {
            return get("title").replace(getSource(), "").replace("-", " ")
                    .trim();
        }
    }

    public String getLink() {
        return get("link");
    }

    public String getPublishDate() {
        return get("pubDate");
    }

    public String getDescription() {
        return get("description");
    }

    public String getSource() {
        if (get("title") == null) {
            return null;
        } else {
            String[] splitString = get("title").split("-");
            return splitString[splitString.length - 1].trim();
        }
    }

    public String getImageThumbnail() {
        return imageThumbnailUrl;
    }

    public String get(String value) {
        try {
            return jsonObject.getString(value);
        } catch (JSONException ignore) {
        }
        return null;
    }

    @Override
    public String toString() {
        return jsonObject.toString();
    }
}